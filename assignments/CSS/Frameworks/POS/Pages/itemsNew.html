<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Items | New</title>
    <meta name="viewport" content="width=device-width initial-scale=1">
    <link rel="stylesheet" href="../../../Boostrap/css/bootstrap.min.css">

    <style>
       /* body>section>section:first-child{
            margin-bottom: 2vh;
        }*/

        body{
            background-color: lightgrey;
        }

        div>div>section>form>div>h5{
            font-size: 15px;
            color: red;
        }
    </style>

</head>
<body>

<section class="container-fluid row" >
    <!--header start-->
    <section>
        <nav class="navbar navbar-expand-lg">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">Navbar</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNavDropdown">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link active" aria-current="page" href="../index.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="invoice_manage_form.html">Orders</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="../Pages/itemsNew.html">Items</a>
                        </li>

                        <li class="nav-item">
                            <a class="nav-link" href="../Pages/customersNew.html">Customers</a>
                        </li>



                    </ul>
                </div>
            </div>
        </nav>
    </section>
    <!--Header end-->

    <div class="row">
        <div class="col-8 justify-content-center">
            <!--Item form start-->
            <section class="col-6">
                <form >
                    <div class="mb-3" >
                          <label for="txtItemCode" class="form-label"><b>Item Code:</b></label>
                        <input type="text" class="form-control" id="txtItemCode" aria-describedby="ID">
                        <h5 id="itemCodeH5"></h5>
                    </div>

                    <div class="mb-3 ">
                          <label for="txtItemName" class="form-label"><b>Item Name:</b></label>
                        <input type="text" class="form-control" id="txtItemName">
                        <h5 id="itemNameH5"></h5>
                    </div>

                    <div class="mb-3">
                        <label for="txtItemPrice" class="form-label"><b>Item Price:</b></label>
                        <input type="number" class="form-control" id="txtItemPrice" aria-describedby="ID">
                        <h5 id="itemPriceH5"></h5>
                    </div>

                    <div class="mb-3">
                        <label for="txtItemQuantity" class="form-label"><b>Item Quantity:</b></label>
                        <input type="number" class="form-control" id="txtItemQuantity" aria-describedby="ID">
                        <h5 id="itemQuantityH5"></h5>
                    </div>

                </form>
            </section>
            <!--Item form end-->
        </div>

        <div class="col justify-content-end" >
            <!--Form Start-->
            <section class="col mx-3 row rounded " style="background-color: white" >

                <div class="row g-3">
                    <div class="col-11 mx-4 ">
                        <input type="text" class="form-control" placeholder="Input Name/NIC/Tp here" aria-label="First name">
                    </div>
                </div>

                <div class="m-4 col-2">
                    <button type="button" class="btn btn-success">Search</button>
                </div>

                <div class="col-6 mt-4">
                    <select class="form-select" aria-label="Default select example" id="dropdownSearch">
                        <option selected="">Name</option>
                        <option value="Item Code">Item Code</option>
                        <option value="NIC">NIC</option>
                    </select>
                </div>
            </section>
            <!--Form end-->
        </div>
    </div>

    <!--Five button start-->
    <section class="col-7 mt-4 mx-2" >
        <div class="btn-group" role="group" aria-label="Basic mixed styles example">
            <button type="button" class="btn btn-danger" id="btnAdd">Add</button>
            <button type="button" class="btn btn-warning">Update</button>
            <button type="button" class="btn btn-info">Delete</button>
            <button type="button" class="btn btn-success">Get All</button>
            <button type="button" class="btn btn-success">Clear</button>
        </div>
    </section>
    <!--Five button end-->

    <!--Table start-->
    <section>
        <table class="table table-success table-striped mt-4 r text-center" >
            <thead>
            <tr >
                <th>Item Code</th>
                <th>Item Name</th>
                <th>Item Price</th>
                <th>Quantity</th>
            </tr>
            </thead>

            <tbody id="tblItems">

            </tbody>
        </table>
    </section>
    <!--Table end-->

</section>


<script src="../../../Boostrap/js/bootstrap.min.js"></script>
<script src="../asserts/js/jquery-3.6.1.min.js"></script>
<script>
    var items = [];

    $("#btnAdd").click(function () {
        let itemCode = $("#txtItemCode").val();
        let itemName = $("#txtItemName").val();
        let itemPrice = $("#txtItemPrice").val();
        let itemQuantity = $("#txtItemQuantity").val();

        var item = {
            itemCode : itemCode,
            itemName : itemName,
            itemPrice : itemPrice,
            itemQuantity : itemQuantity
        }

        alert("Do you really need to add this Item...?");

        items.push(item);

        clearTextFields();

        getAllItems();

        $("#txtItemCode").focus();

    })



    function getAllItems() {
        $("#tblItems").empty();

        for (let item of items) {
            let row = "<tr><td>"+item.itemCode+"</td> <td>"+item.itemName+"</td><td>"+item.itemPrice+"</td><td>"+item.itemQuantity+"</td></tr>";

            $("#tblItems").append(row);
        }

        bindClickEvent();
    }

    function bindClickEvent(){
        $("#tblItems>tr").click(function () {
            $("#txtItemCode").val($(this).children(":eq(0)").text());
            $("#txtItemName").val($(this).children(":eq(1)").text());
            $("#txtItemPrice").val($(this).children(":eq(2)").text());
            $("#txtItemQuantity").val($(this).children(":eq(3)").text());
        });
    }


    $("#txtItemCode").on("keyup",function (event) {
        let regExp = /^(I)[0-9]{3}$/;
        let ifCorrect = regExp.test($("#txtItemCode").val());

        if(!ifCorrect){
            $("#txtItemCode").css("border","1px solid red");
            $("#itemCodeH5").text("Item Code is a required field : Pattern I001");
        }else {
            $("#txtItemCode").css("border","1px solid green");
            $("#itemCodeH5").text("");
        }


        if(event.key=="Enter"){
            $("#txtItemName").focus();
        }
    })

    $("#txtItemName").on("keyup",function (event) {
        let regExp = /^[A-z]{3,}$/;
        let ifCorrect = regExp.test($("#txtItemName").val());

        if(!ifCorrect){
            $("#txtItemName").css("border","1px solid red");
            $("#itemNameH5").text("Item Name is a required field : Minimum 3");
        }else {
            $("#txtItemName").css("border","1px solid green");
            $("#itemNameH5").text("");
        }


        if(event.key=="Enter"){
            $("#txtItemPrice").focus();
        }
    })

    $("#txtItemPrice").on("keyup",function (event) {
        let regExp = /^[0-9.]{2,}$/;
        let ifCorrect = regExp.test($("#txtItemPrice").val());

        if(!ifCorrect){
            $("#txtItemPrice").css("border","1px solid red");
            $("#itemPriceH5").text("Item Price is a required field : 10.00 or 10");
        }else {
            $("#txtItemPrice").css("border","1px solid green");
            $("#itemPriceH5").text("");
        }


        if(event.key=="Enter"){
            $("#txtItemQuantity").focus();
      }
       /* if($("#txtItemPrice").val()==""){
            alert("Null");
        }else{
            alert("Not null");
        }*/
    })

    $("#txtItemQuantity").on("keyup",function (event) {
        let regExp = /^[0-9]{1,}$/;
        let ifCorrect = regExp.test($("#txtItemQuantity").val());

        if(!ifCorrect){
            $("#txtItemQuantity").css("border","1px solid red");
            $("#itemQuantityH5").text("Item Quantity is a required field");
        }else {
            $("#txtItemQuantity").css("border","1px solid green");
            $("#itemQuantityH5").text("");
        }


        if(event.key=="Enter"){
            var item = {
                itemCode: $("#txtItemCode").val(),
                itemName: $("#txtItemName").val(),
                itemPrice: $("#txtItemPrice").val(),
                itemQuantity: $("#txtItemQuantity").val()
            }

            alert("Do you really need to add this Item...?");

            items.push(item);
            getAllItems();

           //clear text fields
            clearTextFields();

            $("#txtItemCode").focus();
        }

    })

    function clearTextFields() {
        $("#txtItemCode").val("");
        $("#txtItemName").val("");
        $("#txtItemPrice").val("");
        $("#txtItemQuantity").val("");

        $("#txtItemCode").css("border","1px solid #ced4da");
        $("#txtItemName").css("border","1px solid #ced4da");
        $("#txtItemPrice").css("border","1px solid #ced4da");
        $("#txtItemQuantity").css("border","1px solid #ced4da");


    }


</script>
</body>
</html>